<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ã‚¿ãƒƒãƒ—ãƒœã‚¹ãƒãƒˆãƒ«</title>
<style>
body {
    background:#111;
    color:white;
    font-family:sans-serif;
    text-align:center;
    margin:0;
}
h1,h2 { margin:10px; }

#stats { font-size:18px; margin:10px; }

#bossSelect button {
    padding:8px 12px;
    margin:4px;
    font-size:14px;
}

#bossArea { font-size:22px; margin:20px; }

#attackBtn {
    width:90%;
    height:100px;
    font-size:30px;
    background:#e53935;
    color:white;
    border:none;
    border-radius:16px;
    margin:20px auto;
    display:block;
}
#attackBtn:active { background:#ff7043; }

#log { min-height:28px; }

#gachaResult { margin:10px; }

#zukan {
    margin-top:20px;
    border-top:1px solid #555;
    padding-top:10px;
}
</style>
</head>
<body>

<h1>âš”ï¸ ã‚¿ãƒƒãƒ—ãƒœã‚¹ãƒãƒˆãƒ«</h1>

<div id="stats">
æ”»æ’ƒåŠ›ï¼š<span id="atk">1</span><br>
ğŸª™ ã‚³ã‚¤ãƒ³ï¼š<span id="coin">0</span>
</div>

<h2>ğŸ§Ÿ ãƒœã‚¹é¸æŠ</h2>
<div id="bossSelect"></div>

<div id="bossArea"></div>

<button id="attackBtn" onclick="attack()">æ”»æ’ƒï¼</button>

<div id="log"></div>

<hr>

<button onclick="gacha(1)">ğŸ° å˜ç™ºï¼ˆ100ï¼‰</button>
<button onclick="gacha(10)">ğŸ° 10é€£ï¼ˆ1000ï¼‰</button>
<button onclick="gacha(100)">ğŸ° 100é€£ï¼ˆ10000ï¼‰</button>
<div id="gachaResult"></div>

<div id="zukan">
<h2>ğŸ“– å›³é‘‘</h2>
<div id="zukanList"></div>
</div>

<script>
/* =====================
   ãƒœã‚¹ãƒ‡ãƒ¼ã‚¿
===================== */
const bosses = [
 { name:"ã‚¹ãƒ©ã‚¤ãƒ ã‚­ãƒ³ã‚°", maxHp:100, unlocked:true, drop:[20,30] },
 { name:"ãƒ€ãƒ¼ã‚¯ã‚¦ãƒ«ãƒ•", maxHp:250, unlocked:false, drop:[60,80] },
 { name:"ãƒ•ãƒ¬ã‚¤ãƒ ãƒ‰ãƒ©ã‚´ãƒ³", maxHp:450, unlocked:false, drop:[120,160] },
 { name:"è™šç„¡ã®ç‹", maxHp:800, unlocked:false, drop:[250,350] },

 { name:"ã‚¢ãƒ“ã‚¹ãƒŠã‚¤ãƒˆ", maxHp:1200, unlocked:false, drop:[400,500] },
 { name:"ãƒ˜ãƒ«ã‚´ãƒ¼ãƒ¬ãƒ ", maxHp:1800, unlocked:false, drop:[600,750] },
 { name:"ã‚«ã‚ªã‚¹ãƒ“ãƒ¼ã‚¹ãƒˆ", maxHp:2600, unlocked:false, drop:[900,1100] },
 { name:"ãƒã‚¯ãƒ­ãƒãƒ³ã‚µãƒ¼", maxHp:3500, unlocked:false, drop:[1300,1600] },
 { name:"å¤ä»£ç«œãƒãƒãƒ ãƒ¼ãƒˆ", maxHp:4800, unlocked:false, drop:[1800,2200] },
 { name:"è™šç©ºã®ç›£è¦–è€…", maxHp:6500, unlocked:false, drop:[2500,3000] },
 { name:"æ˜Ÿå–°ã‚‰ã„", maxHp:8500, unlocked:false, drop:[3500,4200] },
 { name:"æ™‚ç©ºç ´å£Šè€…", maxHp:11000, unlocked:false, drop:[5000,6000] },
 { name:"çµ‚ç„‰ã®ç¥", maxHp:15000, unlocked:false, drop:[8000,10000] },
 { name:"å‰µä¸–ã®è¶…è¶Šè€…", maxHp:22000, unlocked:false, drop:[12000,15000] },

 /* è¶…å¼·åŒ–ãƒœã‚¹ï¼ˆ3å›æ’ƒç ´å¿…è¦ï¼‰ */
 { name:"å¥ˆè½ã®ç ´å£Šç¥", maxHp:50000, unlocked:false, drop:[10000,15000], isExtreme:true, clear:0 },
 { name:"æ˜Ÿæ»…ç«œ", maxHp:120000, unlocked:false, drop:[20000,30000], isExtreme:true, clear:0 },
 { name:"æ™‚ç©ºå–°ã„", maxHp:300000, unlocked:false, drop:[50000,70000], isExtreme:true, clear:0 },
 { name:"æ·±æ·µçš‡å¸", maxHp:700000, unlocked:false, drop:[100000,150000], isExtreme:true, clear:0 },
 { name:"è™šç©ºç¥", maxHp:1500000, unlocked:false, drop:[200000,300000], isExtreme:true, clear:0 },
 { name:"çµ‚ç„‰é¾", maxHp:3000000, unlocked:false, drop:[400000,600000], isExtreme:true, clear:0 },
 { name:"æ¦‚å¿µç ´å£Šè€…", maxHp:6000000, unlocked:false, drop:[800000,1200000], isExtreme:true, clear:0 },
 { name:"ç„¡é™ç‹", maxHp:12000000, unlocked:false, drop:[1500000,2000000], isExtreme:true, clear:0 },
 { name:"å‰µä¸–ç½å„", maxHp:25000000, unlocked:false, drop:[3000000,4000000], isExtreme:true, clear:0 },
 { name:"çµ¶å¯¾ç¥", maxHp:50000000, unlocked:false, drop:[5000000,8000000], isExtreme:true, clear:0 }
];

/* =====================
   ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼
===================== */
let currentBoss = null;
let hp = 0;
let coin = 0;
let atk = 1;

/* =====================
   å›³é‘‘
===================== */
const zukan = {
 "ãƒ¬ã‚¢": { count:0, atk:1 },
 "ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¬ã‚¢": { count:0, atk:3 },
 "ãƒã‚¤ãƒ‘ãƒ¼ãƒ¬ã‚¢": { count:0, atk:5 },
 "ã‚¦ãƒ«ãƒˆãƒ©ãƒ¬ã‚¢": { count:0, atk:10 },
 "ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰ãƒ¬ã‚¢": { count:0, atk:15 }
};

/* =====================
   ãƒœã‚¹UI
===================== */
function updateBossSelect(){
 const div=document.getElementById("bossSelect");
 div.innerHTML="";
 bosses.forEach((b,i)=>{
  const btn=document.createElement("button");
  btn.textContent=b.unlocked?b.name:"ï¼Ÿï¼Ÿï¼Ÿ";
  btn.disabled=!b.unlocked;
  btn.onclick=()=>selectBoss(i);
  div.appendChild(btn);
 });
}

function selectBoss(i){
 currentBoss=i;
 hp=bosses[i].maxHp;
 updateBoss();
 document.getElementById("log").textContent="";
}

function updateBoss(){
 if(currentBoss===null)return;
 const b=bosses[currentBoss];
 document.getElementById("bossArea").innerHTML=
  `ãƒœã‚¹ï¼š${b.name}<br>HPï¼š${hp}/${b.maxHp}`;
}

/* =====================
   æˆ¦é—˜
===================== */
function attack(){
 if(currentBoss===null||hp<=0)return;

 hp-=atk;
 if(hp<0)hp=0;
 updateBoss();

 if(hp===0){
  const b=bosses[currentBoss];

  const d=b.drop;
  const drop=Math.floor(Math.random()*(d[1]-d[0]+1))+d[0];
  coin+=drop;
  document.getElementById("coin").textContent=coin;
  document.getElementById("log").textContent=
   `${b.name} æ’ƒç ´ï¼ğŸª™${drop}`;

  if(b.isExtreme){
   b.clear++;
   if(b.clear>=3 && bosses[currentBoss+1]){
    bosses[currentBoss+1].unlocked=true;
   }
  } else {
   if(bosses[currentBoss+1]){
    bosses[currentBoss+1].unlocked=true;
   }
  }

  updateBossSelect();
  saveGame();
 }
}

/* =====================
   ã‚¬ãƒãƒ£
===================== */
function gacha(times){
 const cost=times*100;
 if(coin<cost){
  document.getElementById("gachaResult").textContent="ã‚³ã‚¤ãƒ³ãŒè¶³ã‚Šãªã„ï¼";
  return;
 }
 coin-=cost;

 let resList=[];
 for(let i=0;i<times;i++){
  const r=Math.random()*100;
  let res;
  if(r<50)res="ãƒ¬ã‚¢";
  else if(r<75)res="ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¬ã‚¢";
  else if(r<90)res="ãƒã‚¤ãƒ‘ãƒ¼ãƒ¬ã‚¢";
  else if(r<98)res="ã‚¦ãƒ«ãƒˆãƒ©ãƒ¬ã‚¢";
  else res="ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰ãƒ¬ã‚¢";

  zukan[res].count++;
  atk+=zukan[res].atk;
  resList.push(res);
 }

 document.getElementById("atk").textContent=atk;
 document.getElementById("coin").textContent=coin;
 document.getElementById("gachaResult").textContent=
  `${times}é€£çµæœï¼š${resList.join(" / ")}`;

 updateZukan();
 saveGame();
}

function updateZukan(){
 document.getElementById("zukanList").innerHTML=
  Object.keys(zukan).map(k=>
   `${k} Ã— ${zukan[k].count}ï¼ˆæ”»æ’ƒåŠ›+${zukan[k].count*zukan[k].atk}ï¼‰`
  ).join("<br>");
}

/* =====================
   ã‚»ãƒ¼ãƒ– / ãƒ­ãƒ¼ãƒ‰
===================== */
function saveGame(){
 localStorage.setItem("tapBossSave",JSON.stringify({
  coin,atk,
  bosses:bosses.map(b=>({unlocked:b.unlocked,clear:b.clear||0})),
  zukan
 }));
}

function loadGame(){
 const data=localStorage.getItem("tapBossSave");
 if(!data)return;
 const save=JSON.parse(data);

 coin=save.coin??coin;
 atk=save.atk??atk;

 save.bosses?.forEach((b,i)=>{
  bosses[i].unlocked=b.unlocked;
  if(bosses[i].isExtreme) bosses[i].clear=b.clear;
 });

 Object.assign(zukan,save.zukan);

 document.getElementById("coin").textContent=coin;
 document.getElementById("atk").textContent=atk;
}

/* =====================
   åˆæœŸåŒ–
===================== */
loadGame();
updateBossSelect();
updateZukan();
</script>

</body>
</html>
